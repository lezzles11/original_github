# effective_knex

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
![NPM Downloads](https://img.shields.io/npm/dw/effective_knex)
[Play with docs](https://zen-out.github.io/modules/effective_knex.html)
## Instructions: 

```js
npm install effective_knex
const effective_knex =  require('effective_knex')
```

## If utilizing in html...: 
```html
<script src="./node_modules/effective_knex/index.js"></script>
<script> 
$(()=> { 
     const output =  effective_knex.method(parameter)
 })
</script>
```

# Purpose

To be able to quickly render a knex post, and match whatever value that you are trying to post to your database 

User Requirements: 

- Users will be able to be confident in their posts (especially if they have more than one definition for a specific item - e.g., could be "easy" in the UI but the label in the database would be 1)
- Users will be able to feel confident in their updates 


```js
       // example of callback - object 
        "difficulty": function(difficulty) {
          if (difficulty === 1) {
              return "easy"
          } else if (difficulty === 2) {
              return "medium"
          } else if (difficulty === 3) {
              return "hard"
          } else if (difficulty === "hard") {
              return 3
          } else if (difficulty === "medium") {
              return 2
          } else if (difficulty === "easy") {
              return 1
          } else {
              return undefined
          }
      },
  await post(knex, table, object, callbacks) // returns trimmed object
  await update(knex, table, id, object, callbacks = undefined) // returns trimmed object
  await updateOne(knex, table, id, key, value) // returns object
  await tableColValCount(knex, table, col, val) // returns number
  await getObjectCount(knex, table, object) // returns number
  await delById(knex, table, id)
  await delByKeyValue(knex, table, key, value)
  await del(knex, table, id, arrOfOtherTables = undefined)
  await getOneById(knex, table, id)
  await getOneByKeyAndValue(knex, table, key, value)
  await getByKeyValue(knex, table, key, value)
  await getByObject(knex, table, object)
  await getAll(knex, table)
  await getInfo(knex, table, "object")
  await getInfo(knex, table, "array")
  await getTables(knex)
  await getForeignTables(knex, table)
  await postFakeData(knex, table, 20)
```

## Functions

<dl>
<dt><a href="#post">post()</a> ⇒ <code>object</code></dt>
<dd></dd>
<dt><a href="#update">update()</a> ⇒ <code>object</code></dt>
<dd></dd>
<dt><a href="#updateOne">updateOne()</a> ⇒ <code>object</code></dt>
<dd><p>updateOne</p>
</dd>
<dt><a href="#cleanPostObject">cleanPostObject()</a> ⇒ <code>any</code></dt>
<dd><ol>
<li>Trims object</li>
<li>If it has id, will delete it </li>
<li>Gets table (only matches with values that has table)</li>
<li>Gets keys from that table</li>
<li>Loops through array </li>
<li>If there is a callback passed in and the key matches the column, then it will assign that to the new object</li>
<li>If the column type doesn&#39;t match the column value</li>
</ol>
</dd>
<dt><a href="#cleanUpdateObject">cleanUpdateObject()</a> ⇒ <code>object</code></dt>
<dd><ol>
<li>Trims object</li>
<li>If it has id, will delete it</li>
<li>Gets table (only matches with values that has table)</li>
<li>Gets keys from that table</li>
<li>Loops through array</li>
<li>If there is a callback passed in and the key matches the column, then it will assign that to the new object</li>
<li>If the column type doesn&#39;t match the column value</li>
</ol>
</dd>
<dt><a href="#tableColValCount">tableColValCount()</a> ⇒ <code>number</code></dt>
<dd></dd>
<dt><a href="#getObjectCount">getObjectCount()</a> ⇒ <code>number</code></dt>
<dd></dd>
<dt><a href="#dataExistsAndMatches">dataExistsAndMatches()</a> ⇒ <code>object</code></dt>
<dd><ol>
<li>Deletes id from the object, if we are posting</li>
<li>Grabs table columns</li>
</ol>
<p>3.Loops through the table column array
4. If the object has that property and the value is not &quot;&quot;
5. Append it to newObj
6. Return newObj</p>
</dd>
<dt><a href="#delByKeyValue">delByKeyValue()</a></dt>
<dd></dd>
<dt><a href="#deleteFromOtherTables">deleteFromOtherTables()</a></dt>
<dd></dd>
<dt><a href="#del">del()</a> ⇒ <code>number</code></dt>
<dd><ul>
<li>If there is a fourth parameter</li>
<li>Get foreign id by table_id</li>
<li>Delete from other tables </li>
<li></li>
</ul>
</dd>
<dt><a href="#getOneById">getOneById()</a> ⇒ <code>object</code></dt>
<dd></dd>
<dt><a href="#getOneByKeyAndValue">getOneByKeyAndValue()</a> ⇒ <code>object</code></dt>
<dd></dd>
<dt><a href="#getByKeyValue">getByKeyValue()</a> ⇒ <code>array</code></dt>
<dd></dd>
<dt><a href="#getByObject">getByObject()</a></dt>
<dd></dd>
<dt><a href="#getAll">getAll()</a> ⇒ <code>array</code></dt>
<dd></dd>
<dt><a href="#handleCallbacks">handleCallbacks()</a> ⇒ <code>any</code></dt>
<dd></dd>
<dt><a href="#getCleanObject">getCleanObject()</a> ⇒ <code>any</code></dt>
<dd><ol>
<li>Trims object</li>
<li>If it has id, will delete it </li>
<li>Gets table (only matches with values that has table)</li>
<li>Gets keys from that table</li>
<li>Loops through array </li>
<li>If there is a callback passed in and the key matches the column, then it will assign that to the new object</li>
<li>If the column type doesn&#39;t match the column value</li>
</ol>
</dd>
<dt><a href="#getInfo">getInfo()</a> ⇒ <code>object</code></dt>
<dd><ol>
<li>Has a dictionary - </li>
<li>Gets knex(table).columnInfo()</li>
<li>if property isn&#39;t created </li>
<li>Push it into array called tableColumns</li>
<li>If third parameter is object, will return key and value pairs of column: type. Else, if third parameter is array, will return an array of the key values</li>
</ol>
</dd>
<dt><a href="#getTables">getTables()</a> ⇒ <code>array</code></dt>
<dd></dd>
<dt><a href="#getForeignTables">getForeignTables()</a> ⇒ <code>any</code></dt>
<dd></dd>
<dt><a href="#getTableBody">getTableBody()</a> ⇒ <code>any</code></dt>
<dd></dd>
<dt><a href="#makeData">makeData(number)</a> ⇒ <code>any</code></dt>
<dd></dd>
<dt><a href="#postFakeData">postFakeData(number)</a> ⇒ <code>any</code></dt>
<dd></dd>
</dl>

<a name="post"></a>

## post() ⇒ <code>object</code>
**Kind**: global function  
**Date**: 2022-03-11  
**Author**: zen-out  
**Example**  
```js
let testPost = await post(knex, "hourglass", { start: "2011-02-02" }, callbacks)
```
<a name="update"></a>

## update() ⇒ <code>object</code>
**Kind**: global function  
**Date**: 2022-03-11  
**Author**: zen-out  
**Example**  
```js
let testUpdate = await update(knex, "hourglass", testPost.id, { start: "2012-02-02" }, callbacks)
```
<a name="updateOne"></a>

## updateOne() ⇒ <code>object</code>
updateOne

**Kind**: global function  
**Date**: 2022-03-16  
**Author**: zen-out  
<a name="cleanPostObject"></a>

## cleanPostObject() ⇒ <code>any</code>
1. Trims object
2. If it has id, will delete it 
3. Gets table (only matches with values that has table)
4. Gets keys from that table
5. Loops through array 
6. If there is a callback passed in and the key matches the column, then it will assign that to the new object
7. If the column type doesn't match the column value

**Kind**: global function  
**Date**: 2022-02-16



s={}  
**Author**: zen-out  
**Example**  
```js
knexCleanObject.cleanPostObject(knex, "hourglass", object, callbacks )
```
<a name="cleanUpdateObject"></a>

## cleanUpdateObject() ⇒ <code>object</code>
1. Trims object
2. If it has id, will delete it
3. Gets table (only matches with values that has table)
4. Gets keys from that table
5. Loops through array
6. If there is a callback passed in and the key matches the column, then it will assign that to the new object
7. If the column type doesn't match the column value

**Kind**: global function  
**Date**: 2022-02-16  
**Author**: zen-out  
<a name="tableColValCount"></a>

## tableColValCount() ⇒ <code>number</code>
**Kind**: global function  
**Date**: 2022-03-10  
**Author**: zen-out  
**Example**  
```js
let getCount = await tableColValCount(knex, table, col, val)
```
<a name="getObjectCount"></a>

## getObjectCount() ⇒ <code>number</code>
**Kind**: global function  
**Date**: 2022-03-23  
**Author**: zen-out  
**Example**  
```js
await getObjectCount(knex, table, object)
```
<a name="dataExistsAndMatches"></a>

## dataExistsAndMatches() ⇒ <code>object</code>
1. Deletes id from the object, if we are posting
2. Grabs table columns 
3.Loops through the table column array
4. If the object has that property and the value is not ""
5. Append it to newObj
6. Return newObj

**Kind**: global function  
**Author**: zen-out  
**Example**  
```js
dataExistsAndMatches(knex, "hourglass", {{ start: '11/11/2011', edit: '2011/11/11', end: '2021-12-03' }})
```
<a name="delByKeyValue"></a>

## delByKeyValue()
**Kind**: global function  
**Author**: github.com/zen-out  
<a name="deleteFromOtherTables"></a>

## deleteFromOtherTables()
**Kind**: global function  
**Author**: github.com/zen-out  
**Example**  
```js
await deleteFromOtherTables(knex, table, id, arrOfOtherTables)
```
<a name="del"></a>

## del() ⇒ <code>number</code>
- If there is a fourth parameter
- Get foreign id by table_id
- Delete from other tables 
-

**Kind**: global function  
**Date**: 2022-03-10  
**Author**: zen-out  
**Example**  
```js
del(knex, table, id, arrOfOtherTables = undefined)
let result2 = await del(knex, "hourglass", 54, ["problem"]).then((result) => {
      let check = typeof result === "object"
      return check;
  })
```
<a name="getOneById"></a>

## getOneById() ⇒ <code>object</code>
**Kind**: global function  
**Date**: 2022-03-10  
**Author**: zen-out  
**Example**  
```js
// getOne(knex, "hourglass", 11).then((result) => {
       //     console.log(result)
       // })
```
<a name="getOneByKeyAndValue"></a>

## getOneByKeyAndValue() ⇒ <code>object</code>
**Kind**: global function  
**Date**: 2022-03-10  
**Author**: zen-out  
**Example**  
```js
// getOne(knex, "hourglass", 11).then((result) => {
   //     console.log(result)
   // })
```
<a name="getByKeyValue"></a>

## getByKeyValue() ⇒ <code>array</code>
**Kind**: global function  
**Date**: 2022-03-15  
**Author**: zen-out  
**Example**  
```js
let result2 = await getByKeyValue(knex, "user", "id", 4).then((result) => {
        console.log(result)
    })
```
<a name="getByObject"></a>

## getByObject()
**Kind**: global function  
**Author**: github.com/zen-out  
**Example**  
```js
await getByObject(knex, "user", {priority: 2})
```
<a name="getAll"></a>

## getAll() ⇒ <code>array</code>
**Kind**: global function  
**Date**: 2022-03-10  
**Author**: zen-out  
**Example**  
```js
// getAll(knex, "hourglass").then((result) => {
    //     console.log(result)
    // })
```
<a name="handleCallbacks"></a>

## handleCallbacks() ⇒ <code>any</code>
**Kind**: global function  
**Date**: 2022-02-16  
**Author**: zen-out  
**Example**  
```js
effective_knex.handleCallbacks({"importance": function(value) {if column is importance, then return 3}}, "importance", 3)
// returns "high"
```
<a name="getCleanObject"></a>

## getCleanObject() ⇒ <code>any</code>
1. Trims object
2. If it has id, will delete it 
3. Gets table (only matches with values that has table)
4. Gets keys from that table
5. Loops through array 
6. If there is a callback passed in and the key matches the column, then it will assign that to the new object
7. If the column type doesn't match the column value

**Kind**: global function  
**Date**: 2022-02-16  
**Author**: zen-out  
<a name="getInfo"></a>

## getInfo() ⇒ <code>object</code>
1. Has a dictionary - 
2. Gets knex(table).columnInfo()
3. if property isn't created 
4. Push it into array called tableColumns
5. If third parameter is object, will return key and value pairs of column: type. Else, if third parameter is array, will return an array of the key values

**Kind**: global function  
**Date**: 2022-02-16  
**Author**: zen-out  
**Example**  
```js
this.getTableInfo(knex, "hourglass", "object")
// returns {emails: string... }
```
<a name="getTables"></a>

## getTables() ⇒ <code>array</code>
**Kind**: global function  
**Date**: 2022-03-10  
**Author**: zen-out  
**Example**  
```js
getTables(knex)
```
<a name="getForeignTables"></a>

## getForeignTables() ⇒ <code>any</code>
**Kind**: global function  
**Date**: 2022-03-10  
**Author**: zen-out  
**Example**  
```js
getForeignTables(knex, table)
// will return ["user"]
```
<a name="getTableBody"></a>

## getTableBody() ⇒ <code>any</code>
**Kind**: global function  
**Date**: 2022-03-10  
**Author**: zen-out  
<a name="makeData"></a>

## makeData(number) ⇒ <code>any</code>
**Kind**: global function  
**Date**: 2022-03-10  
**Author**: zen-out  

| Param | Type |
| --- | --- |
| number | <code>any</code> | 

<a name="postFakeData"></a>

## postFakeData(number) ⇒ <code>any</code>
**Kind**: global function  
**Date**: 2022-03-10  
**Author**: zen-out  

| Param | Type |
| --- | --- |
| number | <code>any</code> | 

