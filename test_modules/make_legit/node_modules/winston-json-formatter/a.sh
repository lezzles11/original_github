#!/usr/bin/env bash

if [ -z ${TAG} ]; then echo "TAG is unset" && exit; fi
if [ -z ${NPM_AUTH_TOKEN} ]; then echo "NPM_AUTH_TOKEN is unset" && exit; fi
if [ -z ${NPM_EMAIL} ]; then echo "NPM_EMAIL is unset" && exit; fi

if [[ $TAG =~ ^([0-9]+)\.([0-9]+)\.([0-9]+)(.*)$ ]]; then
  printf "_auth = $NPM_AUTH_TOKEN\nemail = $NPM_EMAIL\n" > .npmrc
  npm publish
fi
